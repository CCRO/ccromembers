<% if params[:action] == 'show' || (params[:action] == 'index' && post_counter == 0) %>
  <div class="page">
<% end %>
<article id="post-<%= post.id %>" class="<%= "index_post_partial" if params[:action] == 'index' %>">
  <h1 class="post_title">
    <% if params[:action] == 'show' %>
      <span id="post_title" class="mercury-region" data-type="editable"><%= post.title.html_safe %></span>
    <% else %>
      <%= link_to post.title.html_safe, blog_post_path(post)  %>
    <% end %>
    <span class="post_date">
      <% if post.created_at.to_date == Time.now.to_date %>
  			<%= l post.created_at, :format => :time %>
  		<% else %>
  			<%= l post.created_at.to_date, :format => :short %>
  		<% end %>
		</span>
		<% if params[:action] == 'show' %>
  		<% if can? :edit, post %>
    		<%= link_to "/editor" + request.path, class: 'btn', rel: 'tooltip', title: 'Edit Post', id: "edit_link", data: {save_url: mercury_update_blog_post_path(post)} do %>
        	<i class="icon-pencil"></i> Edit Post
      	<% end %>
      <% end %>
  		<% if can? :destroy, post %>
      	<%= link_to blog_post_path(post), :method => 'delete', :class => 'btn btn-danger', :confirm => "Are you sure?" do %>
      	  <i class="icon-remove icon-white"></i> Delete Post
      	<% end %>
      	
      	<% if @post.published == true %>
        	<%= link_to publish_blog_post_path(@post, :published=> false ), {:class =>'btn btn-warning'} do %>
        	  <i class="icon-edit icon-white"></i> Draft Post
        	<% end %>
        <% else %>
    			<%= link_to publish_blog_post_path(@post, :published=> true ), {:class =>'btn btn-success'} do %>
        	  <i class="icon-share icon-white"></i> Publish Post
        	<% end %>
    		<% end %>	
        	
      <% end %>
  	<% end %>
	</h1>
  <% if post.author %><h3>by <%= post.author.name %></h3><% end %>
  <% if params[:action] == 'index' && post_counter > 0 %>
  <%= truncate_html(post.body, :seperator => ' ', :length => 700, :omission => ' ...') %>
  <% else %>
    <p class="post_body"><div id="post_body" class="mercury-region" data-type="editable"><%= post.body.html_safe %></div></p>
  <% end %>
  <br><br>
  <div style="clear: both"></div>
  <div class="post-footer">
  <hr class="hr-small-margin">
  <p class="pull-right"><span class="post-footer-heading">Published: </span><strong><%= t post.created_at.to_s(:long) %></strong></p><p><span class="post-footer-heading">Updated: </span><strong><%= time_ago_in_words post.updated_at %> ago</strong></p>
  <hr class="hr-small-margin hr-dark">
  </div>
</article>
<% if params[:action] == 'show' || (params[:action] == 'index' && post_counter == 0) %>
  </div>
<% end %>

<% if params[:action] == 'show' && post.author && post.author.bio.present? %>
  <div class="">
    <div class="thumbnail pull-left" style="background-color: white; margin-right: 15px;">
      <%= avatar_for post.author %>
        <h5><%= post.author.name %></h5>
        <p><%= post.author.company.name %></p>
      </div>
      <h3>About the author</h3>
      <p><%= post.author.bio %></p>
     <div style="clear: both"></div> 
</div>
<% end %>
